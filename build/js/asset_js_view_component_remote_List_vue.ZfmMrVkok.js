/*! For license information please see asset_js_view_component_remote_List_vue.ZfmMrVkok.js.LICENSE.txt */
"use strict";(self.webpackChunkpmpr_wp_mdl_panel=self.webpackChunkpmpr_wp_mdl_panel||[]).push([["asset_js_view_component_remote_List_vue","asset_js_view_component_remote_Pagination_vue"],{8117:function(t,e,a){a.r(e),a.d(e,{default:function(){return o}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",t._b({},"div",t.container,!1),[t._t("list",null,{loading:t.loading,items:t.items}),t._v(" "),t.hasSlot("list")?t._e():[a("PanelRemoteItems",{attrs:{items:t.items,loading:t.loading},scopedSlots:t._u([{key:"item",fn:function(e){var a=e.item,i=e.item_key,s=e.first,n=e.last;return[t._t("item",null,{item:a,item_key:i,first:s,last:n})]}}],null,!0)})],t._v(" "),t.loading?t._e():[t.hasItems?a("PanelRemotePagination",{attrs:{pagination:t.pagination},on:{onPageChange:t.changePage}}):[t.hasSlot("not-found")?t._e():a("p",{staticClass:"mb-0 mt-4 font-size-h6",domProps:{innerHTML:t._s(t.translate("not_found_record"))}}),t._v(" "),t._t("not-found",null,{text:t.translate("not_found_record")})]]],2)};i._withStripped=!0;var s=a(7108);const n={page:1,sort:"desc",sortBy:"date"},r={page:"page",sort:"sort",sortBy:"sortBy",perPage:"per_page"};var l={name:"PanelRemoteList",data:()=>({items:null,loading:!0,not_found:!1,pagination:{pages:1,total:1,current:1},pages:{},callbacks:{}}),props:{api:{type:String,default:""},reset:{type:Boolean,default:!1},loadOnStart:{type:Boolean,default:!0},itemsPath:{type:String,default:"data.items"},idPath:{type:String,default:"id"},container:{type:Object,default:function(){return{ref:"wrapper",class:"datatable datatable-bordered datatable-head-custom datatable-default datatable-primary"}}},queryParams:{type:Object,default:function(){return r}},queryValues:{type:Object,default:()=>n},paginationPath:{type:[String,Object,Array],default:"data.pagination"},itemTag:{type:String,default:"div"},itemAttrs:{type:Object,default:function(){return{}}}},components:{PanelRemotePagination:s.default},beforeMount(){this.loadData()},mounted(){this.$hook.on("remote-list:refresh",(()=>{this.pages=[],this.loadData()}))},beforeDestroy(){this.$hook.off("remote-list:",!0)},methods:{loadData(){let t=this.getValue(this.pagination,"current",1),e=this.container.ref??"wrapper",a=this.$refs[e],i=this.getValue(this.pages,t);if(this.items={},this.showLoading(),this.$helper.$isEmpty(i)){let e={...r,...this.queryParams},i={...n,...this.queryValues,page:t},s=Object.entries(i).reduce(((t,[a,i])=>(t[e[a]||a]=i,t)),{});this.$api.$get(this.api,{params:this.$api.$prepareParams(s)}).then((async e=>{let i=this.getByPath(e,this.itemsPath,[]);for(let t in i){let e=i[t],a=this.getValue(e,this.idPath,t),s=this.getCallbacks();for(let i in s.normal){let n=s.normal[i];"function"==typeof n&&n(a,t,e[i])}for(let i in s.async){let n=s.async[i];"function"==typeof n&&await n(a,t,e[i])}this.items[a]=e}this.pagination={...this.pagination,...this.getByPath(e,this.paginationPath,{})},this.pages[t]=this.items,this.$nextTick((()=>{this.afterLoad("success",a,e)}))})).catch((t=>{this.items=null,this.afterLoad("error",a,t)}))}else this.items=i,this.hideLoading()},afterLoad(t,e,a){this.emitEvent(`loaded-${t}`,a),this.hideLoading()},changePage(t){this.gotoPage(t)},showLoading(){this.loading=!0,this.emitEvent("loading")},hideLoading(){this.loading=!1,this.emitEvent("loaded")},emitEvent(t,e){this.$emit(`remote-list:${t}`,e)},onChangePage(){},gotoPage(t){let e=parseInt(this.getValue(this.pagination,"current")),a=parseInt(this.getValue(this.pagination,"pages"));t!==e&&t>0&&t<=a&&this.updatePagination(t)},gotoNextPage(){let t=this.getValue(this.pagination,"current");t<this.getValue(this.pagination,"last")&&this.updatePagination(++t)},gotoPrevPage(){let t=this.getValue(this.pagination,"current");t>1&&this.updatePagination(--t)},updatePagination(t){this.pagination=this.setValue(this.pagination,"current",t),this.loadData()},getCallbacks(){return this.$helper.$isEmpty(this.callbacks)&&(this.callbacks={async:[],normal:[]},this.$helper.$each(this.columns,((t,e)=>{let a=t.callback;this.$helper.$isFunction(a)?this.callbacks.normal[e]=a:this.$helper.$isObject(a)&&(a.normal&&(this.callbacks.normal[e]=a.normal),a.async&&(this.callbacks.async[e]=a.async))}))),this.callbacks}},computed:{hasItems(){return!this.$helper.$isEmpty(this.items)}}},o=(0,a(9792).Z)(l,i,[],!1,null,null,null).exports},7108:function(t,e,a){a.r(e),a.d(e,{default:function(){return n}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"datatable-pager d-flex justify-content-between"},[a("ul",{staticClass:"datatable-pager-nav mb-5 mb-md-0"},t._l(t.getPages,(function(e,i){return a("li",{key:i},[t.canRender(e.key)?a("a",{staticClass:"datatable-pager-link",class:[t.isCurrentPage(e.key)&&t.active,t.isDisable(e.key)&&t.disable,"datatable-pager-link-"+e.key],attrs:{title:e.title,disabled:t.isDisable(e.key)},on:{click:function(a){return t.loadPage(e.key)}}},[e.text?a("span",[t._v(t._s(e.text))]):a("PanelIcon",{attrs:{icon:t.getButtonIcon(e.key),size:t.icons.size}})],1):t._e()])})),0),t._v(" "),a("div",{staticClass:"my-auto text-muted"},[t._v(t._s(t.infoText))])])};i._withStripped=!0;var s={name:"PanelRemotePagination",data:()=>({current:1}),props:{attrs:Object,icons:{type:Object,default:()=>({size:"xs"})},active:{type:String,default:"datatable-pager-link-active"},disable:{type:String,default:"datatable-pager-link-disabled"},infoMask:String,eachSide:{type:Number,coerce:function(t){return parseInt(t)},default:2},pagination:{type:Object,default:()=>({total:1,pages:1,current:1,per_page:10})}},events:{"datatable:load-success":t=>{(void 0).pagination=t},"datatable:pagination:set-options":t=>{(void 0).$helper.$each(t,((t,e)=>{(void 0).$set(e,t)}))}},beforeMount(){this.current=this.getPagination("current",this.current)},methods:{getPage(t){let e=this.getValue(this.pagination,"pages",1),a=this.current;switch(t){case"first":t=1;break;case"prev":t=Math.max(a-1,1);break;case"next":t=Math.min(a+1,e);break;case"last":t=e}return parseInt(t)},getButtonIcon(t){let e=this.icons,a={first:"fasm/6/set/angles-right.svg",prev:"fasm/6/set/angle-right.svg",next:"fasm/6/set/angle-left.svg",last:"fasm/6/set/angles-left.svg"}[t];return this.$helper.$isEmpty(e[t])||(a=e[t]),a},loadPage(t){this.isDisable(t)||(this.current=this.getPage(t),this.$emit("onPageChange",this.current))},canRender(t){let e=!0;this.current;return isNaN(parseInt(t))||(e=t+this.eachSide),e},isDisable(t){let e=!1;switch(t){case"first":case"prev":e=this.isFirstPage;break;case"next":case"last":e=this.isLastPage}return e},isCurrentPage(t){return parseInt(t)>0&&parseInt(t)===this.current},getPagination(t,e){return this.getValue(this.pagination,t,e)}},computed:{getPages(){let t=[{key:"first",title:"First Page"},{key:"prev",title:"Previous Page"}],e=this.totalPage;for(let a=0;a<e;a++){let e=this.$intl.number(a+1);t.push({key:a+1,text:e,title:`${e} Page`})}return t.push({key:"next",title:"Next Page"}),t.push({key:"last",title:"Last Page",icon:this.icons.last}),t},infoText(){let t=this.infoMask,e=this.getPagination("per_page",10),a=this.getPagination("total"),i=this.current*e,s=i-(e-1),n=Math.min(i,a);return t||(t=this.translate("pagination.info")),n=this.$intl.number(n),s=this.$intl.number(s),a=this.$intl.number(a),this.$helper.$sprintf(t,[s,n,a])},totalPage(){return this.getPagination("pages",1)},isLastPage(){return this.current>=this.totalPage},isFirstPage(){return 1===this.current}}},n=(0,a(9792).Z)(s,i,[],!1,null,null,null).exports}}]);