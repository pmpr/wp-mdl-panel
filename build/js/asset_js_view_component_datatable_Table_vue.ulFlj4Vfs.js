/*! For license information please see asset_js_view_component_datatable_Table_vue.ulFlj4Vfs.js.LICENSE.txt */
(self.webpackChunkpmpr_wp_pkg_panel=self.webpackChunkpmpr_wp_pkg_panel||[]).push([["asset_js_view_component_datatable_Table_vue"],{5234:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return p}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("PanelCard",{attrs:{title:t.title,description:t.description},scopedSlots:t._u([t.$slots.toolbar?{key:"toolbar",fn:function(){return[t._t("toolbar")]},proxy:!0}:null,{key:"body",fn:function(){return[t._t("before-body"),t._v(" "),a("div",{ref:"wrapper",staticClass:"datatable datatable-bordered datatable-head-custom datatable-default datatable-primary"},[a("table",{staticClass:"datatable-table"},[a("thead",{staticClass:"datatable-head"},[a("tr",{staticClass:"datatable-row"},t._l(t.columns,(function(e,s){return t.getValue(e,"display",!0)?a("th",{key:s,staticClass:"datatable-cell",class:[t.isSortable(e)&&t.SORTABLE_CLASS],style:"width: "+e.width,attrs:{"data-column":s},on:{click:function(a){return t.handleSort(e,s)}}},[t._t("th",null,{item:e,icon:t.sortableIcon}),t._v(" "),t.hasSlot("th")?t._e():a("span",[t._v("\n              "+t._s(e.title)+"\n              "),t.isSortable(e)?a("PanelIcon",{attrs:{icon:t.sortableIcon,size:"xs"}}):t._e()],1)],2):t._e()})),0)]),t._v(" "),t.canRender?a("tbody",{staticClass:"datatable-body"},t._l(t.normalizedItems,(function(e,s){return a("tr",{key:s,staticClass:"datatable-row"},t._l(t.columns,(function(i,n){return t.getValue(i,"display",!0)?a("td",{key:s+"-"+n,class:"datatable-cell"+(i.singleline?" single-line":""),style:"width: "+t.getValue(i,"width")},[t._t("td",null,{item:e,column:i,column_key:n,id:s})],2):t._e()})),0)})),0):a("PanelSpinner")],1),t._v(" "),t.loading?t._e():[t.hasItems?a("PanelDatatablePagination",{attrs:{pagination:t.pagination},on:{onPageChange:t.changePage}}):a("p",{staticClass:"pt-3 mb-0 font-size-h6"},[t._v(t._s(t.translate("not_found_record")))])]],2),t._v(" "),t._t("after-body")]},proxy:!0}],null,!0)})};s._withStripped=!0;var i=a(7221),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"datatable-pager d-flex justify-content-between"},[a("ul",{staticClass:"datatable-pager-nav mb-5 mb-md-0"},t._l(t.getPages,(function(e,s){return a("li",{key:s},[t.canRender(e.key)?a("a",{staticClass:"datatable-pager-link",class:[t.isCurrentPage(e.key)&&t.active,t.isDisable(e.key)&&t.disable,"datatable-pager-link-"+e.key],attrs:{title:e.title,disabled:t.isDisable(e.key)},on:{click:function(a){return t.loadPage(e.key)}}},[e.text?a("span",[t._v(t._s(e.text))]):a("PanelIcon",{attrs:{icon:t.getButtonIcon(e.key),size:t.icons.size}})],1):t._e()])})),0),t._v(" "),a("div",{staticClass:"my-auto text-muted"},[t._v(t._s(t.infoText))])])};n._withStripped=!0;var l={name:"PanelDatatablePagination",data:()=>({current:1}),props:{attrs:Object,icons:{type:Object,default:()=>({size:"xs"})},active:{type:String,default:"datatable-pager-link-active"},disable:{type:String,default:"datatable-pager-link-disabled"},infoMask:String,eachSide:{type:Number,coerce:function(t){return parseInt(t)},default:2},pagination:{type:Object,default:()=>({total:1,pages:1,current:1,perPage:10})}},events:{"datatable:load-success":t=>{(void 0).pagination=t},"datatable:pagination:set-options":t=>{(void 0).$helper.$each(t,((t,e)=>{(void 0).$set(e,t)}))}},beforeMount(){this.current=this.getPagination("current",this.current)},methods:{getPage(t){let e=this.getValue(this.pagination,"pages",1),a=this.current;switch(t){case"first":t=1;break;case"prev":t=Math.max(a-1,1);break;case"next":t=Math.min(a+1,e);break;case"last":t=e}return parseInt(t)},getButtonIcon(t){let e=this.icons,a={first:"fontawesome/angles-right.svg",prev:"fontawesome/angle-right.svg",next:"fontawesome/angle-left.svg",last:"fontawesome/angles-left.svg"}[t];return this.$helper.$isEmpty(e[t])||(a=e[t]),a},loadPage(t){this.isDisable(t)||(this.current=this.getPage(t),this.$emit("onPageChange",this.current))},canRender(t){let e=!0;this.current;return isNaN(parseInt(t))||(e=t+this.eachSide),e},isDisable(t){let e=!1;switch(t){case"first":case"prev":e=this.isFirstPage;break;case"next":case"last":e=this.isLastPage}return e},isCurrentPage(t){return parseInt(t)>0&&parseInt(t)===this.current},getPagination(t,e){return this.getValue(this.pagination,t,e)}},computed:{getPages(){let t=[{key:"first",title:"First Page"},{key:"prev",title:"Previous Page"}],e=this.totalPage;for(let a=0;a<e;a++)t.push({key:a+1,text:a+1,title:`${a} Page`});return t.push({key:"next",title:"Next Page"}),t.push({key:"last",title:"Last Page",icon:this.icons.last}),t},infoText(){let t=this.infoMask,e=this.getPagination("perPage",10),a=this.getPagination("total"),s=this.current*e,i=s-(e-1),n=Math.min(s,a);return t||(t=this.translate("pagination.info")),this.$helper.$sprintf(t,[i,n,a])},totalPage(){return this.getPagination("pages",1)},isLastPage(){return this.current>=this.totalPage},isFirstPage(){return 1===this.current}}},r=a(9792),o=(0,r.Z)(l,n,[],!1,null,null,null);o.options.__file="asset/js/view/component/datatable/Pagination.vue";var h=o.exports;const c={page:1,sort:"desc",sortBy:"date"},u={page:"page",sort:"sort",sortBy:"sortBy",perPage:"per_page"};var d={data:()=>({items:null,loading:!0,pagination:{pages:1,total:1,current:1},pages:{},callbacks:{},SORTED_CLASS:"datatable-cell-sorted",SORTABLE_CLASS:"datatable-cell-sort"}),props:{api:{type:String,required:!0},reset:{type:Boolean,default:!1},loadOnStart:{type:Boolean,default:!0},title:String,columns:[Object,Array],itemsPath:{type:String,default:"data.items"},idPath:{type:String,default:"id"},queryParams:{type:Object,default:u},queryValues:{type:Object,default:()=>c},description:String,paginationPath:{type:[String,Object,Array],default:"data.pagination"}},components:{PanelDatatablePagination:h},beforeMount(){this.loadData()},methods:{loadData(){let t=this.getValue(this.pagination,"current",1),e=this.$refs.wrapper,a=this.getValue(this.pages,t);if(this.items={},this.showLoading(),this.$helper.$isEmpty(a)){let a=this.$jwt.$getToken(),s={...u,...this.queryParams},i={...c,...this.queryValues,page:t};this.$api.$setToken(a);let n=Object.entries(i).reduce(((t,[e,a])=>(t[s[e]||e]=a,t)),{});this.$api.$get(this.api,{params:this.$api.$prepareParams(n)}).then((async a=>{let s=this.getByPath(a,this.itemsPath,[]);for(let t in s){let e=s[t],a=this.getValue(e,this.idPath),i=this.getCallbacks();for(let s in i.normal){let n=i.normal[s];"function"==typeof n&&n(a,t,e[s])}for(let s in i.async){let n=i.async[s];"function"==typeof n&&await n(a,t,e[s])}this.items[a]=e}this.pagination={...this.pagination,...this.getByPath(a,this.paginationPath,{})},this.pages[t]=this.items,this.$nextTick((()=>{this.afterLoad("success",e,a)}))})).catch((t=>{this.items=null,this.afterLoad("error",e,t)}))}else this.items=a,this.hideLoading()},afterLoad(t,e,a){this.emitEvent(`loaded-${t}`,a),this.hideLoading()},changePage(t){this.gotoPage(t)},isSortable(t){return this.getValue(t,"sortable",!0)},handleSort(t,e){if(this.isSortable(t)){let t="esc",a=i.Z.find(document.body,`th[data-column="${e}"]`);if(i.Z.hasClass(a,this.SORTED_CLASS))t=a.getAttribute("data-sort"),t="esc"===t?"desc":"esc";else{if(!this.$helper.$isEmpty(a)){let t=a.parentNode,e=i.Z.find(t,`.${this.SORTED_CLASS}`);this.$helper.$isEmpty(e)||i.Z.removeClass(e,this.SORTED_CLASS)}i.Z.addClass(a,this.SORTED_CLASS)}a.setAttribute("data-sort",t),this.items=null,this.queryValues.sort=t,this.loadData()}},showLoading(){this.loading=!0,this.emitEvent("loading")},hideLoading(){this.loading=!1,this.emitEvent("loaded")},emitEvent(t,e){this.$emit(`datatable:${t}`,e)},onChangePage(){},gotoPage(t){let e=parseInt(this.getValue(this.pagination,"current")),a=parseInt(this.getValue(this.pagination,"pages"));t!==e&&t>0&&t<=a&&this.updatePagination(t)},gotoNextPage(){let t=this.getValue(this.pagination,"current");t<this.getValue(this.pagination,"last")&&this.updatePagination(++t)},gotoPrevPage(){let t=this.getValue(this.pagination,"current");t>1&&this.updatePagination(--t)},updatePagination(t){this.pagination=this.setValue(this.pagination,"current",t),this.loadData()},normalizeItem(t){let e={};return this.$helper.$each(this.columns,((a,s)=>{let i,n=a.path||s,l=a.normalize;i=this.getByPath(t,n),"function"==typeof l&&(i=l(i,t,e)),e[s]=i})),e},getCallbacks(){return this.$helper.$isEmpty(this.callbacks)&&(this.callbacks={async:[],normal:[]},this.$helper.$each(this.columns,((t,e)=>{let a=t.callback;this.$helper.$isFunction(a)?this.callbacks.normal[e]=a:this.$helper.$isObject(a)&&(a.normal&&(this.callbacks.normal[e]=a.normal),a.async&&(this.callbacks.async[e]=a.async))}))),this.callbacks}},computed:{hasItems(){return!this.$helper.$isEmpty(this.items)},canRender(){return!this.loading||!this.$helper.$isEmpty(this.items)},tableAttrs(){return{...this.getValue(this.attrs,"table",{}),table:{class:"datatable-table d-block"},thead:{class:"datatable-head"},tbody:{class:"datatable-body"},tr:{class:"datatable-row"}}},sortableIcon:()=>"fontawesome/arrow-up.svg",normalizedItems(){let t={};return this.$helper.$each(this.items,((e,a)=>{t[a]=this.normalizeItem(e)})),t}}},g=(0,r.Z)(d,s,[],!1,null,null,null);g.options.__file="asset/js/view/component/datatable/Table.vue";var p=g.exports}}]);