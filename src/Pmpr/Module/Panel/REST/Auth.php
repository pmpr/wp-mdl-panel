<?php
/*   _______________________________________
    |  Obfuscated by PMPR - Php Obfuscator  |
    |             6838de209d7b5             |
    |_______________________________________|
*/
 namespace Pmpr\Module\Panel\REST; use Exception; use Pmpr\Common\Foundation\FormGenerator\Field; use Pmpr\Common\Foundation\Interfaces\Constants; use Pmpr\Module\Panel\Security; use WP_Error; use WP_HTTP_Response; use WP_REST_Request; use WP_REST_Response; use Pmpr\Module\Panel\Setting as ModuleSetting; class Auth extends Common { const gagkiiqqiysqqgmc = 'register'; const isawmsicsoammssc = 'email_otp'; const mmoiwccmooyskayc = 'mobile_otp'; const soawgaqmsgmysyma = 'reset_password'; const igswqqsosoeiociu = 'forgot_password'; const ykykecaaygoeyuuq = 'traditional_login'; const scagkwwiiquocimc = 'last_name'; const kagqiwogmiguosiw = 'first_name'; const oysqakmiwsaqskce = 'repeat_password'; protected ?WP_Error $error = null; public function __construct() { $this->rest_base = 'auth'; parent::__construct(); } public function wigskegsqequoeks() { $this->qcsmikeggeemccuu('wp_logout', [$this, 'oywwmwwwqeuiomka'], 999); } public function kgquecmsgcouyaya() { $this->cecaguuoecmccuse('reset_pre_dispatch', [$this, 'ywsiiikuswoyowaw'])->cecaguuoecmccuse('determine_current_user', [$this, 'aeicekasgokuuoqm']); $this->aqaqisyssqeomwom('get_jwt_auth_user', [$this, 'issssuygyewuaswa'])->aqaqisyssqeomwom('get_jwt_auth_token', [$this, 'sygeeqgwywmygsyu']); parent::kgquecmsgcouyaya(); } public function euekiyuksecoccus() : ?WP_Error { return $this->error; } public function yauwooaeicgosquo(?WP_Error $iswcokucwmiosiaq) : void { $this->error = $iswcokucwmiosiaq; } public function register_routes() { $this->register('/get-login-providers', [Constants::wwgusigoaksqmwsm => [$this, 'vomyocgeymkomqqm']]); $this->register('/get-fields', [Constants::wwgusigoaksqmwsm => [$this, 'ugmceccgwaaaigiy']]); $this->register('/send-code', [Constants::oaggieeykyaoiiyw => self::qucyckeykeuuaquw, Constants::wwgusigoaksqmwsm => [$this, 'iyogyoekowaukeyo']]); $this->register('/signup', [Constants::oaggieeykyaoiiyw => self::qucyckeykeuuaquw, Constants::wwgusigoaksqmwsm => [$this, 'iomcmomaekkccmaa']]); $this->register('/login', [Constants::oaggieeykyaoiiyw => self::qucyckeykeuuaquw, Constants::wwgusigoaksqmwsm => [$this, 'kkmkcysyceyiwskq']]); $this->register('/logout', [Constants::oaggieeykyaoiiyw => self::qucyckeykeuuaquw, Constants::wwgusigoaksqmwsm => [$this, 'aiamgkiewwakoegy']]); $this->register('/verify', [Constants::wwgusigoaksqmwsm => [$this, 'ussowkigumoaoowo']]); $this->register('/change-password', [Constants::oaggieeykyaoiiyw => self::ouuaeeeqeqkagcgi, Constants::wwgusigoaksqmwsm => [$this, 'agcywkwaoqkkccgk']]); $this->register('/me', [Constants::wwgusigoaksqmwsm => [$this, 'auosyisuakguyimw']]); $this->register('/forgot-password', [Constants::wwgusigoaksqmwsm => [$this, 'eaoyggyoikqaeeec']]); $this->woekqgykywwycyci(); } public function aeicekasgokuuoqm($mkucggyaiaukqoce) { $qoockacwwamsuscm = $this->uwkmaywceaaaigwo()->giiecckwoyiawoyy()->ymsasggoakmgguqk(); $wigqmiauciuswcom = $this->caokeucsksukesyo()->giiecckwoyiawoyy()->ekcymmyqoceukosc(); if (strpos($wigqmiauciuswcom, $qoockacwwamsuscm) && strpos($wigqmiauciuswcom, '/panel/auth/verify')) { $keccaugmemegoimu = $this->sygeeqgwywmygsyu(false); if (is_wp_error($keccaugmemegoimu) && $keccaugmemegoimu->get_error_code() !== 'no_auth_header') { $this->yauwooaeicgosquo($keccaugmemegoimu); } else { [$mgegoogckgsumooq, $smecmmgoykqcaieu] = $keccaugmemegoimu; $mkucggyaiaukqoce = $smecmmgoykqcaieu->data->user->id; } } return $mkucggyaiaukqoce; } public function oywwmwwwqeuiomka($mkucggyaiaukqoce) { } public function vomyocgeymkomqqm(WP_REST_Request $aqmwamyiwgeeymqa) { if ($this->caokeucsksukesyo()->eiwcuqigayigimak()->yyccecocgwykyaeo()) { $ukiskwsmqscwauuu = $this->ocksiywmkyaqseou('third_party_auth_login_providers', []); if ($ukiskwsmqscwauuu) { foreach ($ukiskwsmqscwauuu as $momcykaoccoymeig => $iwigiqwyskocowwo) { $wkaqekwwgqsqwcoi = $iwigiqwyskocowwo[Constants::qgqyauaqwqmqseim] ?? null; if (is_numeric($wkaqekwwgqsqwcoi)) { $ukiskwsmqscwauuu[$momcykaoccoymeig][Constants::qgqyauaqwqmqseim] = $this->caokeucsksukesyo()->iqsmaqoiukeasukw()->mgaeeqsgeoukeokc($wkaqekwwgqsqwcoi); } } $keccaugmemegoimu = $ukiskwsmqscwauuu; } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('there is no login provider.', PR__MDL__PANEL), 404); } } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Registration is not enabled.', PR__MDL__PANEL), 404); } return $this->ewmkmmsuiuwmmwoy($keccaugmemegoimu); } public function ugmceccgwaaaigiy(WP_REST_Request $aqmwamyiwgeeymqa) { $ikgwqyuyckaewsow = $this->cqsmgqiwwuasmkiq(); if ($ikgwqyuyckaewsow) { foreach ($ikgwqyuyckaewsow as $ymqmyyeuycgmigyo => $ccamueccusigaaio) { foreach ($ccamueccusigaaio as $momcykaoccoymeig => $aiowsaccomcoikus) { if ($aiowsaccomcoikus instanceof Field) { $aiowsaccomcoikus->uuagoowwgcuosuuu()->eumecwmqmukqgyea()->qigsyyqgewgskemg('form-control-solid')->gkkgsyeumismsyse('font-size-h6 text-dark'); $ikgwqyuyckaewsow[$ymqmyyeuycgmigyo][$momcykaoccoymeig] = $aiowsaccomcoikus; if ($ccamueccusigaaio === self::gagkiiqqiysqqgmc) { $aiowsaccomcoikus->smcqugueqiumkygs(); } } } $this->ocksiywmkyaqseou("panel_auth_{$ymqmyyeuycgmigyo}_fields", $ccamueccusigaaio); $ikgwqyuyckaewsow[$ymqmyyeuycgmigyo] = $this->ayssaocauwgssywa($ccamueccusigaaio); } $keccaugmemegoimu = $ikgwqyuyckaewsow; } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('can not found requested fields.', PR__MDL__PANEL), 404); } return $this->ewmkmmsuiuwmmwoy($keccaugmemegoimu); } public function mmusmqyoussiyygq(WP_REST_Request $aqmwamyiwgeeymqa, string $ccamueccusigaaio) : array { $icwicymcioeyeyek = []; $ikgwqyuyckaewsow = $this->cqsmgqiwwuasmkiq($ccamueccusigaaio); if ($ikgwqyuyckaewsow) { foreach ($ikgwqyuyckaewsow as $aiowsaccomcoikus) { if ($aiowsaccomcoikus instanceof Field) { $eqgoocgaqwqcimie = $this->swmwoeaaeqiouswg($aqmwamyiwgeeymqa, $aiowsaccomcoikus->mwikyscisascoeea(), $aiowsaccomcoikus->oiswysuiioecsaae()); if (!$eqgoocgaqwqcimie && $aiowsaccomcoikus->msmiagueogcsucgc()) { $icwicymcioeyeyek = false; break; } $icwicymcioeyeyek[$aiowsaccomcoikus->mwikyscisascoeea()] = $eqgoocgaqwqcimie; } } } return $icwicymcioeyeyek; } private function cqsmgqiwwuasmkiq(string $ccamueccusigaaio = Constants::ALL) : array { $gusoaiguqeaommcc = $this->caokeucsksukesyo()->kugiyqykwaskawsc(); if (Constants::gseiuyggikuamsak === $this->weysguygiseoukqw(ModuleSetting::sieuimaseocuuyem)) { $ymwmimkuaqwgkgqc = __('Email', PR__MDL__PANEL); if (0) { $ymwmimkuaqwgkgqc = __('Email or Mobile', PR__MDL__PANEL); } $yswauyuuckmyciwi = [$gusoaiguqeaommcc->ymuegqgyuagyucws(Constants::miqkwqsewyogmsak)->qigsyyqgewgskemg('text-center')->gswweykyogmsyawy($ymwmimkuaqwgkgqc)->kqqqugemmqagucuq()]; $gmsquaqoucwysesw = null; if ($this->caokeucsksukesyo()->cqusmgskowmesgcg()->iqqgmieeqemiowuk('security')) { $gmsquaqoucwysesw = Security::symcgieuakksimmu()->oguouwowueiqyocs('g-recaptcha-response', Constants::iickqyckyaqcaokm, 'auth'); } $scagwgcigmqkugcy = []; if ($gmsquaqoucwysesw) { $scagwgcigmqkugcy[] = $gmsquaqoucwysesw; } $ikgwqyuyckaewsow = ['identifier_entry' => $yswauyuuckmyciwi, 'auth_method' => $scagwgcigmqkugcy, self::isawmsicsoammssc => [$gusoaiguqeaommcc->ymuegqgyuagyucws(Constants::gseiuyggikuamsak)->ougkuowgkuqmwkka(5)], self::mmoiwccmooyskayc => [$gusoaiguqeaommcc->ymuegqgyuagyucws(Constants::gseiuyggikuamsak)->ougkuowgkuqmwkka(5)], 'password_auth' => [$gusoaiguqeaommcc->ymuegqgyuagyucws(Constants::iqgqyoowkoeugsck)->gswweykyogmsyawy(__('Enter Your Password', PR__MDL__PANEL))->sqsumkuougquscyg(), $gmsquaqoucwysesw]]; } else { $yswauyuuckmyciwi = [$gusoaiguqeaommcc->ymuegqgyuagyucws(Constants::miqkwqsewyogmsak)->gswweykyogmsyawy(__('Email or Username', PR__MDL__PANEL))->kqqqugemmqagucuq(), $gusoaiguqeaommcc->ymuegqgyuagyucws(Constants::iqgqyoowkoeugsck)->gswweykyogmsyawy(__('Password', PR__MDL__PANEL))->sqsumkuougquscyg()]; if ($this->caokeucsksukesyo()->cqusmgskowmesgcg()->iqqgmieeqemiowuk('security')) { $yswauyuuckmyciwi[] = Security::symcgieuakksimmu()->oguouwowueiqyocs('g-recaptcha-response', Constants::iickqyckyaqcaokm, 'auth'); } $ikgwqyuyckaewsow = ['identifier_entry' => $yswauyuuckmyciwi, self::igswqqsosoeiociu => [$gusoaiguqeaommcc->ymuegqgyuagyucws(Constants::muqaqimusmckkieq)->gswweykyogmsyawy(__('Your Email', PR__MDL__PANEL))->mkiaygiogeeyogqm()]]; if ($this->caokeucsksukesyo()->eiwcuqigayigimak()->yyccecocgwykyaeo()) { $ikgwqyuyckaewsow[Constants::gagkiiqqiysqqgmc] = [$gusoaiguqeaommcc->ymuegqgyuagyucws(self::kagqiwogmiguosiw)->gswweykyogmsyawy(__('Firstname', PR__MDL__PANEL)), $gusoaiguqeaommcc->ymuegqgyuagyucws(self::scagkwwiiquocimc)->gswweykyogmsyawy(__('Lastname', PR__MDL__PANEL)), $gusoaiguqeaommcc->ymuegqgyuagyucws(Constants::csiaccacwgeeqwwo)->gswweykyogmsyawy(__('Username', PR__MDL__PANEL))->kqqqugemmqagucuq(), $gusoaiguqeaommcc->ymuegqgyuagyucws(Constants::muqaqimusmckkieq)->gswweykyogmsyawy(__('Email', PR__MDL__PANEL))->mkiaygiogeeyogqm(), $gusoaiguqeaommcc->ymuegqgyuagyucws(Constants::akywgoyaseymiyka)->gswweykyogmsyawy(__('Password', PR__MDL__PANEL))->sqsumkuougquscyg(), $gusoaiguqeaommcc->ymuegqgyuagyucws(self::oysqakmiwsaqskce)->gswweykyogmsyawy(__('Repeat Password', PR__MDL__PANEL))->sqsumkuougquscyg()]; } } $ikgwqyuyckaewsow = (array) $this->ocksiywmkyaqseou('panel_auth_fields', $ikgwqyuyckaewsow); return $this->caokeucsksukesyo()->ywqgcuymeiswqyqc()->get($ikgwqyuyckaewsow, $ccamueccusigaaio, $ikgwqyuyckaewsow); } public function eaoyggyoikqaeeec(WP_REST_Request $aqmwamyiwgeeymqa) { $owaiikyuwwwmswgc = $this->uwkmaywceaaaigwo()->gksccikkaamikckm()->email($this->aemeowyaecqmymas($aqmwamyiwgeeymqa, Constants::muqaqimusmckkieq)); $keccaugmemegoimu = []; if ($this->uwkmaywceaaaigwo()->gyecsegqciqykomu()->qkgmsqgmwoamekyk($owaiikyuwwwmswgc)) { if ($this->uwkmaywceaaaigwo()->issssuygyewuaswa()->uyoiiusukoigeusy($owaiikyuwwwmswgc)) { try { $mkucggyaiaukqoce = $this->issssuygyewuaswa($aqmwamyiwgeeymqa); $akguowqemgmmqoym = $this->uwkmaywceaaaigwo()->issssuygyewuaswa()->sisqmmikmeuogcou($mkucggyaiaukqoce); if (is_wp_error($akguowqemgmmqoym)) { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Error on generate reset key.', PR__MDL__PANEL), 500); } else { } } catch (Exception $wgaoewqkwgomoaai) { return $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis($wgaoewqkwgomoaai, 500); } } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('No user found with this email address.', PR__MDL__PANEL), 404); } } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('The Email you entered is not valid.', PR__MDL__PANEL), 400); } return $this->ewmkmmsuiuwmmwoy($keccaugmemegoimu); } public function agcywkwaoqkkccgk(WP_REST_Request $aqmwamyiwgeeymqa) { $mkucggyaiaukqoce = $this->issssuygyewuaswa($aqmwamyiwgeeymqa); if (!is_wp_error($mkucggyaiaukqoce)) { $yeacayasgueouoqc = $this->aemeowyaecqmymas($aqmwamyiwgeeymqa, Constants::asmooogmgyecqqka); $qqwegysogaocgeww = $this->aemeowyaecqmymas($aqmwamyiwgeeymqa, Constants::akywgoyaseymiyka); if ($qqwegysogaocgeww && $yeacayasgueouoqc) { if ($yeacayasgueouoqc === $qqwegysogaocgeww) { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Entered current password and new password is same.', PR__MDL__PANEL), 400); } else { if ($this->uwkmaywceaaaigwo()->gyecsegqciqykomu()->eoiyuwsiwqyqiyom($yeacayasgueouoqc, $mkucggyaiaukqoce->user_pass, $mkucggyaiaukqoce->ID)) { $keccaugmemegoimu = new WP_Error(); $this->cqscqicucmeamkyq('validate_password_reset', $keccaugmemegoimu, $mkucggyaiaukqoce); if (!$keccaugmemegoimu->has_errors()) { $this->uwkmaywceaaaigwo()->issssuygyewuaswa()->sqaoqqooqowugmcw($mkucggyaiaukqoce, $qqwegysogaocgeww); $keccaugmemegoimu = $this->qasywwyamoesisyi(__('Password changed successfully', PR__MDL__PANEL)); } } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Entered current password is not correct.', PR__MDL__PANEL), 400); } } } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Missing parameter.', PR__MDL__PANEL), 400); } } else { $keccaugmemegoimu = $mkucggyaiaukqoce; } return $this->ewmkmmsuiuwmmwoy($keccaugmemegoimu); } public function woekqgykywwycyci() { $uykgysuswksgmwqy = 'Access-Control-Allow-Headers, Content-Type, Authorization'; header(sprintf('Access-Control-Allow-Headers: %s', $uykgysuswksgmwqy)); } public function ywsiiikuswoyowaw(WP_REST_Request $aqmwamyiwgeeymqa) { $iswcokucwmiosiaq = $this->euekiyuksecoccus(); if (is_wp_error($iswcokucwmiosiaq)) { $aqmwamyiwgeeymqa = $iswcokucwmiosiaq; } return $aqmwamyiwgeeymqa; } public function aiamgkiewwakoegy(WP_REST_Request $aqmwamyiwgeeymqa) { $this->uwkmaywceaaaigwo()->issssuygyewuaswa()->aiamgkiewwakoegy(); return $this->ewmkmmsuiuwmmwoy($this->qasywwyamoesisyi(__('Logged out', PR__MDL__PANEL))); } public function iyogyoekowaukeyo(WP_REST_Request $aqmwamyiwgeeymqa) { $moeywsaososecuqg = $this->aemeowyaecqmymas($aqmwamyiwgeeymqa, Constants::miqkwqsewyogmsak); if ($moeywsaososecuqg) { $ussowkigumoaoowo = $this->ocksiywmkyaqseou('panel_auth_verify', true, $aqmwamyiwgeeymqa, 'send_code'); if (is_wp_error($ussowkigumoaoowo)) { $keccaugmemegoimu = $ussowkigumoaoowo; } else { if ($this->caokeucsksukesyo()->cqusmgskowmesgcg()->iqqgmieeqemiowuk('otp', Constants::ycaueuokiswkqaoc)) { $ckggaguoewuaukyu = pr_utility_otp_get_request(); $sogksuscggsicmac = $ckggaguoewuaukyu->ioimaaeesiaysecu($moeywsaososecuqg, $this->caokeucsksukesyo()->issssuygyewuaswa()->mmscegoieayuaguo()); if ($sogksuscggsicmac && !is_wp_error($sogksuscggsicmac)) { $uuyoeicyoayimaoa = $ckggaguoewuaukyu->cwowqcisacowuqec(); $keccaugmemegoimu = ['expire_text' => sprintf(__('The submission code will be sent after %s.', PR__MDL__PANEL), $this->caokeucsksukesyo()->wgqqgewcmcemoewo()->ciuuiyckmsygceis('%s')), Constants::cgiswgcumueqgcmw => $uuyoeicyoayimaoa * MINUTE_IN_SECONDS, Constants::mgowaqweusymwoqu => sprintf('%s<br>%s', sprintf(__('A temporary login code has been sent to the %s below:', PR__MDL__PANEL), $ckggaguoewuaukyu->yomgsemomcmgekyi(Constants::squoamkioomemiyi, $sogksuscggsicmac[Constants::iikosyqiawkweouo])), sprintf(__('Check %s & %s folders', PR__MDL__PANEL), 'Inbox', 'Spam'))]; } else { if (!is_wp_error($sogksuscggsicmac)) { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Cannot send the code right now. Please try again later.', PR__MDL__PANEL), 503); } else { $keccaugmemegoimu = $sogksuscggsicmac; } } } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Something went wrong, We can\'t send the code right now. Please contact us.', PR__MDL__PANEL), 503); } } } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Entered values is not valid.', PR__MDL__PANEL), 400); } return $this->ewmkmmsuiuwmmwoy($keccaugmemegoimu); } public function iomcmomaekkccmaa(WP_REST_Request $aqmwamyiwgeeymqa) { if (Constants::mcwaoqwywimcegca !== $this->weysguygiseoukqw(ModuleSetting::sieuimaseocuuyem)) { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Registration is currently only available via OTP. Please use the correct method to signup.', PR__MDL__PANEL)); } else { if (!$this->caokeucsksukesyo()->eiwcuqigayigimak()->yyccecocgwykyaeo()) { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('User registration is currently disabled. Please try again later or contact the site administrator.', PR__MDL__PANEL)); } else { if ($icwicymcioeyeyek = $this->mmusmqyoussiyygq($aqmwamyiwgeeymqa, self::gagkiiqqiysqqgmc)) { $ewgmommeawggyaek = $this->uwkmaywceaaaigwo()->issssuygyewuaswa(); $owaiikyuwwwmswgc = $icwicymcioeyeyek[Constants::muqaqimusmckkieq] ?? ''; $qqwegysogaocgeww = $icwicymcioeyeyek[Constants::akywgoyaseymiyka] ?? ''; $yewiaiaauukwsgku = $icwicymcioeyeyek[Constants::csiaccacwgeeqwwo] ?? ''; if ($ewgmommeawggyaek->uyoiiusukoigeusy($owaiikyuwwwmswgc)) { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Email already exists, please try Forget Password.', PR__MDL__PANEL), 400); } else { if ($ewgmommeawggyaek->wskwomgayscmiwqy($yewiaiaauukwsgku)) { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Username already exists, please enter another username.', PR__MDL__PANEL), 400); } else { $assuqkuiuewumqyu = $icwicymcioeyeyek[self::oysqakmiwsaqskce]; if ($assuqkuiuewumqyu !== $qqwegysogaocgeww) { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Passwords are not same.', PR__MDL__PANEL), 400); } else { $oeucsuyqysaciasy = $this->caokeucsksukesyo()->wikusamwomuogoau()->ggocakcisguuokai() ? Constants::qkimqmacosgcwmug : $this->caokeucsksukesyo()->eiwcuqigayigimak()->gogwcwsmseqqukuq(); $keccaugmemegoimu = $ewgmommeawggyaek->gesyeyeaqmiskuoo($yewiaiaauukwsgku, $qqwegysogaocgeww, $owaiikyuwwwmswgc); if (!is_wp_error($keccaugmemegoimu)) { $mkucggyaiaukqoce = $this->caokeucsksukesyo()->issssuygyewuaswa()->get($keccaugmemegoimu); if ($mkucggyaiaukqoce) { $miemcogcecyqwsea = $ewgmommeawggyaek->igawqaomowicuayw(Constants::kagqiwogmiguosiw, $keccaugmemegoimu); $eqmqoaiqqsgwqgcs = $ewgmommeawggyaek->igawqaomowicuayw(Constants::scagkwwiiquocimc, $keccaugmemegoimu); $fkgqmwkusywysaus = trim($miemcogcecyqwsea . ' ' . $eqmqoaiqqsgwqgcs); if ($fkgqmwkusywysaus) { $mkucggyaiaukqoce->display_name = $fkgqmwkusywysaus; } $mkucggyaiaukqoce->set_role($oeucsuyqysaciasy); foreach ($icwicymcioeyeyek as $uusmaiomayssaecw => $eqgoocgaqwqcimie) { $mkucggyaiaukqoce->{$uusmaiomayssaecw} = $eqgoocgaqwqcimie; } $ewgmommeawggyaek->update($mkucggyaiaukqoce); $keccaugmemegoimu = $this->qasywwyamoesisyi(__('Your account created successfully.', PR__MDL__PANEL), $mkucggyaiaukqoce); } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('User not found.', PR__MDL__PANEL)); } } } } } } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Entered values is not valid.', PR__MDL__PANEL), 400); } } } return $this->ewmkmmsuiuwmmwoy($keccaugmemegoimu); } public function kkmkcysyceyiwskq(WP_REST_Request $aqmwamyiwgeeymqa) { $moeywsaososecuqg = $this->aemeowyaecqmymas($aqmwamyiwgeeymqa, Constants::miqkwqsewyogmsak); if ($moeywsaososecuqg) { $yoiguusocukqeayg = $this->caokeucsksukesyo()->issssuygyewuaswa(); $ewgmommeawggyaek = $this->uwkmaywceaaaigwo()->issssuygyewuaswa(); $ewgmommeawggyaek->aiamgkiewwakoegy(); $ycoeoaakqyskgykq = $keccaugmemegoimu = null; try { $fwigoyyqcikqyoyq = $this->uwkmaywceaaaigwo()->gksccikkaamikckm(); foreach ($aqmwamyiwgeeymqa->get_params() as $ymqmyyeuycgmigyo => $euwkouuykmaieusi) { $ymqmyyeuycgmigyo = $fwigoyyqcikqyoyq->key($ymqmyyeuycgmigyo); $euwkouuykmaieusi = $fwigoyyqcikqyoyq->aoeoykwemwaqsikc($euwkouuykmaieusi); $_POST[$ymqmyyeuycgmigyo] = $euwkouuykmaieusi; $_REQUEST[$ymqmyyeuycgmigyo] = $euwkouuykmaieusi; } if ($qqwegysogaocgeww = $this->aemeowyaecqmymas($aqmwamyiwgeeymqa, Constants::iqgqyoowkoeugsck)) { $mkucggyaiaukqoce = $ewgmommeawggyaek->hmisgsqkawsgmqou([Constants::miqkwqsewyogmsak => $moeywsaososecuqg, Constants::iqgqyoowkoeugsck => $qqwegysogaocgeww]); if (is_wp_error($mkucggyaiaukqoce)) { $keccaugmemegoimu = $mkucggyaiaukqoce; } else { $ycoeoaakqyskgykq = $yoiguusocukqeayg->iooowgsqoyqseyuu($mkucggyaiaukqoce); } } else { if ($eqiqeycqwqiygcmg = $this->aemeowyaecqmymas($aqmwamyiwgeeymqa, Constants::gseiuyggikuamsak)) { if ($this->caokeucsksukesyo()->cqusmgskowmesgcg()->iqqgmieeqemiowuk('otp', Constants::ycaueuokiswkqaoc)) { $ckggaguoewuaukyu = pr_utility_otp_get_request(); $weeieoygyecwmikq = $ckggaguoewuaukyu->seeeuukuamcwiymk($moeywsaososecuqg, $eqiqeycqwqiygcmg); if (!is_wp_error($weeieoygyecwmikq)) { $ycoeoaakqyskgykq = $ckggaguoewuaukyu->waecsyqmwascmqoa($weeieoygyecwmikq, Constants::yauicucwkgqyygas); if (!$ycoeoaakqyskgykq) { $yewiaiaauukwsgku = $yoiguusocukqeayg->yqacukkgousiuaqq(current(explode('@', $moeywsaososecuqg))); $qqwegysogaocgeww = $ewgmommeawggyaek->myuiaumaacseywog(); $owaiikyuwwwmswgc = null; $gsikmsakcyiwacac = $ckggaguoewuaukyu->ogegcqqcukiaqscy(Constants::squoamkioomemiyi, $weeieoygyecwmikq); switch ($gsikmsakcyiwacac) { case Constants::muqaqimusmckkieq: $owaiikyuwwwmswgc = $moeywsaososecuqg; break; case Constants::skogicecygyyskkq: $owaiikyuwwwmswgc = $moeywsaososecuqg . '@example.local'; break; } $ycoeoaakqyskgykq = $ewgmommeawggyaek->gesyeyeaqmiskuoo($yewiaiaauukwsgku, $qqwegysogaocgeww, $owaiikyuwwwmswgc); if (is_wp_error($ycoeoaakqyskgykq)) { if ($gsikmsakcyiwacac === Constants::skogicecygyyskkq) { $yoiguusocukqeayg->ksmqawcowkmegigw(Constants::igqmgugkkecmgmos, $moeywsaososecuqg, $ycoeoaakqyskgykq); } $keccaugmemegoimu = $ycoeoaakqyskgykq; $ycoeoaakqyskgykq = 0; } } } else { $keccaugmemegoimu = $weeieoygyecwmikq; } } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Something went wrong, We can\'t send the code right now. Please contact us.', PR__MDL__PANEL), 503); } } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->cackyykusuowuiwg(); } } if ($ycoeoaakqyskgykq && !is_wp_error($keccaugmemegoimu)) { $mkucggyaiaukqoce = $yoiguusocukqeayg->get($ycoeoaakqyskgykq, true); if ($mkucggyaiaukqoce) { $ewgmommeawggyaek->kkkuqwaqakeaykmo($ycoeoaakqyskgykq, $mkucggyaiaukqoce->user_login); $ewgmommeawggyaek->qsgmugaqymqgqayy($ycoeoaakqyskgykq); $this->cqscqicucmeamkyq('wp_login', $mkucggyaiaukqoce->user_login, $mkucggyaiaukqoce); $keccaugmemegoimu = $this->ysyiouymigoigsma($ycoeoaakqyskgykq); } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('Can not login now, please try later.', PR__MDL__PANEL)); } } } catch (Exception $wgaoewqkwgomoaai) { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis($wgaoewqkwgomoaai, 500); } } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->cackyykusuowuiwg(); } return $this->ewmkmmsuiuwmmwoy($keccaugmemegoimu); } public function ussowkigumoaoowo($aqmwamyiwgeeymqa) { $keccaugmemegoimu = $this->sygeeqgwywmygsyu($aqmwamyiwgeeymqa); if (!is_wp_error($keccaugmemegoimu)) { [$mgegoogckgsumooq, $smecmmgoykqcaieu] = $keccaugmemegoimu; $keccaugmemegoimu = [Constants::meksegaoamowuwoq => $this->ksoemussqmaacucm($smecmmgoykqcaieu->data->user->id), Constants::sygmkaeayiiouiwm => $mgegoogckgsumooq]; } return $this->ewmkmmsuiuwmmwoy($keccaugmemegoimu); } public function auosyisuakguyimw(WP_REST_Request $aqmwamyiwgeeymqa) { $keccaugmemegoimu = $this->sygeeqgwywmygsyu($aqmwamyiwgeeymqa); if (!is_wp_error($keccaugmemegoimu)) { [$mgegoogckgsumooq, $smecmmgoykqcaieu] = $keccaugmemegoimu; $keccaugmemegoimu = [Constants::meksegaoamowuwoq => $this->ksoemussqmaacucm($smecmmgoykqcaieu->data->user->id), Constants::uiwqcumqkgikqyue => [Constants::ciywsqoeiymemsys => 200], Constants::vswoiouoaykswgym => 'auth_get_me', 'account' => []]; } return $this->ewmkmmsuiuwmmwoy($keccaugmemegoimu); } }
