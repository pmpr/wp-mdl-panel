<?php
/*   _______________________________________
    |  Obfuscated by PMPR - Php Obfuscator  |
    |             694c4d8938815             |
    |_______________________________________|
*/
 namespace Pmpr\Module\Panel\Traits; use Firebase\JWT\JWT; use Firebase\JWT\Key; use Pmpr\Common\Foundation\Interfaces\Constants; use Pmpr\Module\Panel\User; use WP_Error; trait TokenTrait { public function ysyiouymigoigsma($ycoeoaakqyskgykq) { if ($emoqwwkmassqsoaw = $this->aumueocimuaiwyee()) { $ggmuwmqmcisegoea = time(); $wekousyuiguacggm = $ggmuwmqmcisegoea + (int) $this->ocksiywmkyaqseou('panel_auth_cookie_expiration', DAY_IN_SECONDS, $ycoeoaakqyskgykq); $mgseigywcgwcccsi = $this->uwkmaywceaaaigwo()->giiuwsmyumqwwiyq()->ciqkaakiwsgqwiqu(Constants::auqoykcmsiauccao); $mgegoogckgsumooq = ['uid' => $ycoeoaakqyskgykq, 'iat' => $ggmuwmqmcisegoea, 'iss' => $mgseigywcgwcccsi, 'sub' => $mgseigywcgwcccsi, 'nbf' => $ggmuwmqmcisegoea, 'aud' => 'https://identitytoolkit.googleapis.com/google.identity.identitytoolkit.v1.IdentityToolkit', 'exp' => $wekousyuiguacggm, 'data' => [Constants::meksegaoamowuwoq => [Constants::gouqcwikiiygyasc => $ycoeoaakqyskgykq]]]; $mgegoogckgsumooq = JWT::encode($mgegoogckgsumooq, $emoqwwkmassqsoaw, 'HS256'); $keccaugmemegoimu = [Constants::meksegaoamowuwoq => $this->ksoemussqmaacucm($ycoeoaakqyskgykq), Constants::sygmkaeayiiouiwm => $mgegoogckgsumooq, Constants::uikygkewwaiowmwe => $wekousyuiguacggm]; } else { $keccaugmemegoimu = $this->caokeucsksukesyo()->euekiyuksecoccus()->gosmqcmmomkqwmis(__('JWT is not configured properly.', PR__MDL__PANEL), 500); } return $keccaugmemegoimu; } public function aumueocimuaiwyee() : ?string { return (string) $this->caokeucsksukesyo()->eiwcuqigayigimak()->cmaecekuqkwmemms('SECURE_AUTH_KEY', 'auth-secret-key'); } public function ksoemussqmaacucm($mkucggyaiaukqoce) : array { $yoiguusocukqeayg = $this->caokeucsksukesyo()->issssuygyewuaswa(); $ewgmommeawggyaek = $this->uwkmaywceaaaigwo()->issssuygyewuaswa(); $mkucggyaiaukqoce = $yoiguusocukqeayg->get($mkucggyaiaukqoce); $oeucsuyqysaciasy = $yoiguusocukqeayg->eueceegwomaqgqca($mkucggyaiaukqoce, true); return ['account' => [Constants::eyqgmoumkowegyse => $oeucsuyqysaciasy, Constants::csiaccacwgeeqwwo => $mkucggyaiaukqoce->user_login, 'role_title' => $yoiguusocukqeayg->qeoyqaaakwcwyqcy($oeucsuyqysaciasy), 'registered' => $mkucggyaiaukqoce->user_registered, 'can_view_admin_panel' => $ewgmommeawggyaek->yciaosuiyeieceug($mkucggyaiaukqoce, 'edit_posts')], 'personal' => User::symcgieuakksimmu()->ksoemussqmaacucm($mkucggyaiaukqoce)]; } }
